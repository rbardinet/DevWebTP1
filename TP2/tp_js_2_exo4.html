
<!-- saved from url=(0050)https://vbarreaud.github.io/JS_TP_1/exo5/exo5.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

		<title>3</title>
		<style type="text/css">	
		</style>

		<script>

		

		function initMain(){

			const objectsInGame = new Array();
			var x = 0;
			var pixPs = 10;
			var waittime=1000000;
			var SquareInter = 3000;
			var waitbuffer=0;
			var CptInterval;
			var mainCanvas;
			
			initCanvas();
			console.log("initCanvas2");
			


			function initCanvas()
				{
					mainCanvas=document.getElementById('myCanvas');
					console.log("initCanvas");

			}
			
		

			function waiter(){
				//console.log("in waiter");
				if(true){
					waitbuffer+=100;
					//console.log("add 100 to waitbuffer");
					resetCanvas();


					
					
					for (var i=0; i<objectsInGame.length; i++){

						if(Math.floor(waitbuffer/SquareInter)>=i){

							console.log("i = "+i);

							objectsInGame[i].draw(objectsInGame[i].x+pixPs,objectsInGame[i].y,objectsInGame[i].context);	

						}

						

					}

		
				}else{
					clearInterval(CptInterval);
				}
			}


			function resetCanvas(){

				var ctx = mainCanvas.getContext("2d");

				ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);
				var w = ctx.canvas.width;
				ctx.canvas.width = 1;
				ctx.canvas.width = w;
			}

			class Square{
					constructor(x,y,context){
						this.x = x;
						this.y = y;
						this.context = context;
					}

					clear(){
						this.context.clearRect(this.x, this.y, this.width, this.height);
					}

					update(){
							console.log("update");				
					}

					draw(x,y){
						console.log("draw contex.canvas.width = "+this.context.canvas.width);
						if(this.x<=this.context.canvas.width - 50){
							
							console.log("draw x = "+this.x);
							this.context.beginPath();
							this.context.rect(x,0,50,50);
							this.context.fillStyle="red";
							this.context.fill();
							this.x = x;
						}else{
							console.log("clearing Interval in square . draw")
							//clearInterval(CptInterval);
						}
					}

					
				}

			

			const square1 = new Square(0,0,mainCanvas.getContext("2d"));
			const square2 = new Square(0,0,mainCanvas.getContext("2d"));
			const square3 = new Square(0,0,mainCanvas.getContext("2d"));

			
			objectsInGame.push(square1);
			objectsInGame.push(square2);
			objectsInGame.push(square3);
			

			CptInterval = setInterval(waiter,100);

		}


		</script>

	</head>
	<body onload="initMain()">

		<canvas id="myCanvas" width="600" height="600" style="border: 1px solid rgb(140, 107, 202);"></canvas>
	

</body></html>